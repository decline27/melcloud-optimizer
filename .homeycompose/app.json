{
  "id": "com.melcloud.optimize",
  "version": "14.0.25",
  "compatibility": ">=12.2.0",
  "sdk": 3,
  "platforms": [
    "local"
  ],
  "name": {
    "en": "MELCloud Optimizer"
  },
  "description": {
    "en": "Optimize your MELCloud heat pump based on electricity prices and weather"
  },
  "category": [
    "climate"
  ],
  "permissions": [
    "homey:manager:api"
  ],
  "author": {
    "name": "Kjetil Vetlejord",
    "email": "decline27@gmail.com"
  },
  "images": {
    "large": "/assets/images/large.png",
    "small": "/assets/images/small.png"
  },
  "brandColor": "#1E88E5",
  "homeyCommunityTopicId": 136325,
  "support": "https://github.com/decline27/melcloud-optimizer/issues",
  "widgets": {
    "melcloud-data": {
      "name": {
        "en": "Live Model Confidence"
      },
      "height": 620,
      "settings": [],
      "api": {
        "getModelConfidence": {
          "method": "GET",
          "path": "/getModelConfidence"
        }
      },
      "id": "melcloud-data"
    }
  },
  "capabilities": {
    "heating_cop": {
      "type": "number",
      "title": {
        "en": "Heating COP"
      },
      "desc": {
        "en": "Coefficient of Performance for heating system"
      },
      "units": {
        "en": "COP"
      },
      "decimals": 2,
      "min": 0,
      "max": 10,
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "icon": "/assets/icon.svg"
    },
    "hotwater_cop": {
      "type": "number",
      "title": {
        "en": "Hot Water COP"
      },
      "desc": {
        "en": "Coefficient of Performance for hot water system"
      },
      "units": {
        "en": "COP"
      },
      "decimals": 2,
      "min": 0,
      "max": 10,
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "icon": "/assets/icon.svg"
    },
    "holiday_mode": {
      "type": "boolean",
      "title": {
        "en": "Holiday Mode"
      },
      "getable": true,
      "setable": true,
      "uiComponent": "toggle"
    },
    "prohibit_hotwater": {
      "type": "boolean",
      "title": {
        "en": "Prohibit Hot Water"
      },
      "getable": true,
      "setable": true,
      "uiComponent": "toggle"
    },
    "prohibit_heating.zone1": {
      "type": "boolean",
      "title": {
        "en": "Prohibit Heating - Zone 1"
      },
      "getable": true,
      "setable": true,
      "uiComponent": "toggle"
    },
    "prohibit_cooling.zone1": {
      "type": "boolean",
      "title": {
        "en": "Prohibit Cooling - Zone 1"
      },
      "getable": true,
      "setable": true,
      "uiComponent": "toggle"
    },
    "prohibit_heating.zone2": {
      "type": "boolean",
      "title": {
        "en": "Prohibit Heating - Zone 2"
      },
      "getable": true,
      "setable": true,
      "uiComponent": "toggle"
    },
    "prohibit_cooling.zone2": {
      "type": "boolean",
      "title": {
        "en": "Prohibit Cooling - Zone 2"
      },
      "getable": true,
      "setable": true,
      "uiComponent": "toggle"
    },
    "legionella_now": {
      "type": "boolean",
      "title": {
        "en": "Start Legionella Cycle"
      },
      "getable": true,
      "setable": true,
      "uiComponent": "toggle"
    },
    "occupied": {
      "type": "boolean",
      "title": {
        "en": "Home/Away State"
      },
      "getable": true,
      "setable": true,
      "uiComponent": "toggle"
    }
  },
  "flow": {
    "triggers": [],
    "conditions": [],
    "actions": [
      {
        "id": "get_entsoe_prices",
        "title": {
          "en": "Fetch ENTSO-E day-ahead prices"
        },
        "hint": {
          "en": "Returns hourly prices for the selected ENTSO-E price area."
        },
        "args": [
          {
            "name": "zone",
            "type": "text",
            "title": {
              "en": "Zone (ISO or EIC)"
            },
            "placeholder": {
              "en": "SE3 or 10YSE-3--------J"
            }
          }
        ],
        "tokens": [
          {
            "name": "prices_json",
            "type": "string",
            "title": {
              "en": "Prices JSON"
            },
            "example": "[{\"ts_iso_utc\":\"2024-01-01T00:00:00.000Z\",\"price_eur_per_kwh\":0.12}]"
          }
        ]
      }
    ]
  },
  "api": {
    "getRunHourlyOptimizer": {
      "method": "GET",
      "path": "/runHourlyOptimizer"
    },
    "getRunWeeklyCalibration": {
      "method": "GET",
      "path": "/runWeeklyCalibration"
    },
    "getCheckCronStatus": {
      "method": "GET",
      "path": "/getCheckCronStatus"
    },
    "getUpdateCronStatus": {
      "method": "GET",
      "path": "/getUpdateCronStatus"
    },
    "getStartCronJobs": {
      "method": "GET",
      "path": "/getStartCronJobs"
    },
    "getDeviceList": {
      "method": "GET",
      "path": "/getDeviceList"
    },
    "getThermalModelData": {
      "method": "GET",
      "path": "/getThermalModelData"
    },
    "getCOPData": {
      "method": "GET",
      "path": "/getCOPData"
    },
    "getWeeklyAverageCOP": {
      "method": "GET",
      "path": "/getWeeklyAverageCOP"
    },
    "updateOptimizerSettings": {
      "method": "GET",
      "path": "/updateOptimizerSettings"
    },
    "getMelCloudStatus": {
      "method": "GET",
      "path": "/getMelCloudStatus"
    },
    "getTibberStatus": {
      "method": "GET",
      "path": "/getTibberStatus"
    },
    "getTibberHomes": {
      "method": "GET",
      "path": "/getTibberHomes"
    },
    "runSystemHealthCheck": {
      "method": "GET",
      "path": "/runSystemHealthCheck"
    },
    "runThermalDataCleanup": {
      "method": "GET",
      "path": "/runThermalDataCleanup"
    },
    "postHotWaterResetPatterns": {
      "method": "POST",
      "path": "/hot-water/reset-patterns"
    },
    "postHotWaterClearData": {
      "method": "POST",
      "path": "/hot-water/clear-data"
    },
    "getHotWaterPatterns": {
      "method": "GET",
      "path": "/hot-water/patterns"
    },
    "validateAndStartCron": {
      "method": "GET",
      "path": "/validateAndStartCron"
    },
    "getModelConfidence": {
      "method": "GET",
      "path": "/getModelConfidence"
    },
    "updateAllServiceTimezones": {
      "method": "GET",
      "path": "/updateAllServiceTimezones"
    },
    "updatePriceProvider": {
      "method": "GET",
      "path": "/updatePriceProvider"
    }
  }
}